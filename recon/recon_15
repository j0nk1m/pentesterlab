#OBJECTIVE
#For this challenge, your goal is to perform a zone transfer on the internal 
#zone named: "int" using the nameserver of z.hackycorp.com.

#ZONE TRANSFER
#Zone transfers are usually used to synchronise multiple DNS servers. Only a 
#list of pre-defined hosts should be able to perform this operation. However, 
#it's sometimes possible to retrieve information from internal zones by asking 
#publicly available servers.

#dig @z.hackycorp.com int axfr

import dns.zone
import dns.resolver
        
domain="z.hackycorp.com"
ns = dns.resolver.resolve(domain, 'NS')
for server in ns:
    print(server.target)
    ip = dns.resolver.resolve(server.target, 'A')
    for a in ip:
        print(a)
        z = dns.zone.from_xfr(dns.query.xfr(str(a), "int"))
        for n in z: print(z[n].to_text(n))
